Kasuta XAMPPis SQL kood:
-- 1. Loo kasutaja

CREATE USER IF NOT EXISTS 'opilaneArtur'@'localhost'

IDENTIFIED BY '12345';

-- 2. Loo andmebaas

CREATE DATABASE IF NOT EXISTS aknarulood

CHARACTER SET utf8mb4

COLLATE utf8mb4_estonian_ci;

-- 3. Anna õigused kasutajale opilane

GRANT ALL PRIVILEGES ON rulood.* TO 'arturOpilane'@'localhost';

FLUSH PRIVILEGES;

-- 4. Kasuta andmebaasi

USE aknarulood;

-- 5. Loo tabel rulood

CREATE TABLE IF NOT EXISTS rulood (
    id INT AUTO_INCREMENT PRIMARY KEY,
    mustrinr INT NOT NULL,
    riievalmis BOOLEAN,
    puuvalmis BOOLEAN,
    pakitud BOOLEAN
);

-- Admin ja tavakasutaja tuvastamine

-- 1. Loo tabel kasutajad

CREATE TABLE kasutajad (
    id INT AUTO_INCREMENT PRIMARY KEY,
    kasutajanimi VARCHAR(50) NOT NULL UNIQUE,
    parool VARCHAR(255) NOT NULL,
    roll ENUM('admin','user', 'puu', 'riide', 'komplekt') NOT NULL
);

-- 2. Sisestan sinna admini

INSERT INTO kasutajad (kasutajanimi, parool, roll)
VALUES ('admin', SHA2('admin123', 256), 'admin');

-- 3. Sisestan sinna tavakasutaja

INSERT INTO kasutajad (kasutajanimi, parool, roll)
VALUES ('kasutaja', SHA2('user123', 256), 'user');

-- 4. Sisestan sinna puuosakonna töötaja

INSERT INTO kasutajad (kasutajanimi, parool, roll)
VALUES ('puu', SHA2('puu123', 256), 'puu');

-- 5. Sisestan sinna puuosakonna töötaja

INSERT INTO kasutajad (kasutajanimi, parool, roll)
VALUES ('riide', SHA2('riide123', 256), 'riide');

-- 6. Sisestan sinna komplekteetija töötaja

INSERT INTO kasutajad (kasutajanimi, parool, roll)
VALUES ('komplekt', SHA2('komplekt123', 256), 'komplekt');

-- Mustrinumbri tellimuse lisamine

INSERT INTO rulood (mustrinr)
VALUES (?);

-- Riidelõikuse valmiks märkimine id järgi

UPDATE rulood SET riievalmis = 1 where id = ?

-- Rulood, kus riie ja puu valmis, aga pole pakitud

SELECT * FROM rulood
WHERE riievalmis = 1 AND puuvalmis = 1 AND pakitud = 0

